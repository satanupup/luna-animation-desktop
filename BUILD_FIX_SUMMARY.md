# ğŸ”§ ç·¨è­¯å•é¡Œä¿®å¾©ç¸½çµ

## ğŸ“‹ å•é¡Œæè¿°

åŸå§‹å•é¡Œï¼šç·¨è­¯å¾Œçš„æ‡‰ç”¨ç¨‹å¼ç„¡æ³•ä½¿ç”¨ GIF è¼¸å‡ºåŠŸèƒ½ï¼Œå‡ºç¾ "âŒ æœªæ‰¾åˆ° FFmpeg" éŒ¯èª¤ã€‚

### ğŸ” æ ¹æœ¬åŸå› åˆ†æ

1. **Windows ç¬¦è™Ÿé€£çµæ¬Šé™å•é¡Œ**
   - electron-builder çš„ winCodeSign åŒ…å« macOS ç¬¦è™Ÿé€£çµ
   - Windows ç³»çµ±é è¨­ä¸å…è¨±ä¸€èˆ¬ç”¨æˆ¶å‰µå»ºç¬¦è™Ÿé€£çµ
   - 7-Zip è§£å£“ç¸®æ™‚é‡åˆ°æ¬Šé™é™åˆ¶

2. **FFmpeg è·¯å¾‘å•é¡Œ**
   - æ‰“åŒ…å¾Œçš„æ‡‰ç”¨ç¨‹å¼ä¸­ï¼ŒFFmpeg æ²’æœ‰è¢«æ­£ç¢ºåŒ…å«
   - è·¯å¾‘æª¢æ¸¬é‚è¼¯ä¸é©ç”¨æ–¼æ‰“åŒ…ç’°å¢ƒ

## âœ… è§£æ±ºæ–¹æ¡ˆ

### ğŸ¯ é‡è¦æ›´æ–°ï¼š`npm run build` å·²æ•´åˆæ‰€æœ‰ä¿®å¾©åŠŸèƒ½

ç¾åœ¨åŸ·è¡Œ `npm run build` æœƒè‡ªå‹•ï¼š
1. ä½¿ç”¨ electron-packager ç·¨è­¯æ‡‰ç”¨ç¨‹å¼
2. è‡ªå‹•è¤‡è£½ FFmpeg åˆ°ç·¨è­¯ç›®éŒ„
3. æ¸¬è©¦ GIF è¼¸å‡ºåŠŸèƒ½
4. é©—è­‰ç·¨è­¯çµæœ

**ä¸€å€‹å‘½ä»¤è§£æ±ºæ‰€æœ‰å•é¡Œï¼** âœ¨

### 1. ä½¿ç”¨ electron-packager æ›¿ä»£ electron-builder

```bash
npm run build:packager
```

**å„ªé»ï¼š**
- é¿å… winCodeSign ç¬¦è™Ÿé€£çµå•é¡Œ
- ç·¨è­¯éç¨‹æ›´ç©©å®š
- ä¸éœ€è¦ç®¡ç†å“¡æ¬Šé™

### 2. ä¿®å¾© FFmpeg è·¯å¾‘æª¢æ¸¬

ä¿®æ”¹ `src/main.js` ä¸­çš„ FFmpeg æª¢æ¸¬é‚è¼¯ï¼š
- æ”¯æ´æ‰“åŒ…å’Œé–‹ç™¼ç’°å¢ƒçš„ä¸åŒè·¯å¾‘
- å¤šè·¯å¾‘æª¢æ¸¬æ©Ÿåˆ¶
- è©³ç´°çš„é™¤éŒ¯æ—¥èªŒ

### 3. è‡ªå‹• FFmpeg è¤‡è£½

å‰µå»º `tools/copy-ffmpeg-to-build.js` è…³æœ¬ï¼š
- è‡ªå‹•è¤‡è£½ FFmpeg åˆ°ç·¨è­¯ç›®éŒ„
- é©—è­‰è¤‡è£½çµæœ
- æ”¯æ´å¤šå€‹ç·¨è­¯ç›®æ¨™

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æ¨™æº–ç·¨è­¯ï¼ˆæ¨è–¦ï¼‰

```bash
# æ¨™æº– npm build å‘½ä»¤ï¼Œå·²æ•´åˆæ‰€æœ‰ä¿®å¾©åŠŸèƒ½
npm run build
```

### å…¶ä»–ç·¨è­¯æ–¹å¼

```bash
# ä½¿ç”¨æ‰¹æ¬¡æª”ï¼ˆWindowsï¼‰
.\build-with-ffmpeg.bat

# æˆ–ä½¿ç”¨å°ˆç”¨è…³æœ¬
npm run build:with-ffmpeg
```

### åˆ†æ­¥é©Ÿç·¨è­¯

```bash
# 1. ç·¨è­¯æ‡‰ç”¨ç¨‹å¼
npm run build:packager

# 2. è¤‡è£½ FFmpeg
npm run copy:ffmpeg

# 3. æ¸¬è©¦ GIF è¼¸å‡ºåŠŸèƒ½
npm run test:gif:output
```

### å®Œæ•´æ¸¬è©¦æµç¨‹

```bash
# æ¨™æº–ç·¨è­¯ï¼ˆå·²åŒ…å«å®Œæ•´çš„ç·¨è­¯ã€è¤‡è£½å’Œæ¸¬è©¦ï¼‰
npm run build

# æˆ–åŸ·è¡Œæœ€çµ‚æ¸¬è©¦ï¼ˆåŒ…å«æ¸…ç†ï¼‰
npm run test:final
```

## ğŸ“Š æ–°å¢çš„æ¸¬è©¦è…³æœ¬

| è…³æœ¬ | åŠŸèƒ½ | ç”¨é€” |
|------|------|------|
| `npm run build` | **å®Œæ•´ç·¨è­¯æµç¨‹** | **ç·¨è­¯+FFmpeg+æ¸¬è©¦ï¼ˆæ¨è–¦ï¼‰** |
| `npm run test:build` | ç·¨è­¯ç’°å¢ƒè¨ºæ–· | æª¢æŸ¥ç·¨è­¯ç’°å¢ƒå’Œä¾è³´ |
| `npm run fix:build` | è‡ªå‹•ä¿®å¾©ç·¨è­¯å•é¡Œ | ä¿®å¾©å¸¸è¦‹ç·¨è­¯å•é¡Œ |
| `npm run build:solution` | æä¾›è§£æ±ºæ–¹æ¡ˆ | é¡¯ç¤ºç·¨è­¯å•é¡Œè§£æ±ºæ–¹æ¡ˆ |
| `npm run verify:build` | é©—è­‰ç·¨è­¯çµæœ | æª¢æŸ¥ç·¨è­¯è¼¸å‡ºå®Œæ•´æ€§ |
| `npm run copy:ffmpeg` | è¤‡è£½ FFmpeg | å°‡ FFmpeg è¤‡è£½åˆ°ç·¨è­¯ç›®éŒ„ |
| `npm run test:gif:output` | æ¸¬è©¦ GIF è¼¸å‡º | é©—è­‰ GIF è¼¸å‡ºåŠŸèƒ½ |
| `npm run build:with-ffmpeg` | ç·¨è­¯+FFmpeg | å®Œæ•´ç·¨è­¯æµç¨‹ |
| `npm run test:final` | æœ€çµ‚æ¸¬è©¦ | å®Œæ•´çš„ç·¨è­¯æ¸¬è©¦æµç¨‹ |

## ğŸ¯ ç·¨è­¯çµæœ

### âœ… æˆåŠŸæŒ‡æ¨™

- æ‡‰ç”¨ç¨‹å¼åŸ·è¡Œæª”ï¼š`dist/ç’å¨œçš„ GIF å‹•ç•«è£½ä½œå™¨-win32-x64/ç’å¨œçš„ GIF å‹•ç•«è£½ä½œå™¨.exe`
- FFmpeg åŸ·è¡Œæª”ï¼š`dist/ç’å¨œçš„ GIF å‹•ç•«è£½ä½œå™¨-win32-x64/ffmpeg.exe`
- æª”æ¡ˆå¤§å°ï¼šç´„ 168.62 MBï¼ˆä¸»ç¨‹å¼ï¼‰+ 515.5 KBï¼ˆFFmpegï¼‰
- FFmpeg ç‰ˆæœ¬ï¼šN-121001-gadc66f30ee-20250906

### ğŸ§ª åŠŸèƒ½é©—è­‰

```bash
# æ¸¬è©¦ FFmpeg å¯ç”¨æ€§
npm run test:gif:output

# åŸ·è¡Œ UI æ¸¬è©¦
npm run test:ui:click
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¦‚æœç·¨è­¯å¤±æ•—

1. **æª¢æŸ¥ç’°å¢ƒ**ï¼š
   ```bash
   npm run test:build
   ```

2. **è‡ªå‹•ä¿®å¾©**ï¼š
   ```bash
   npm run fix:build
   ```

3. **æŸ¥çœ‹è§£æ±ºæ–¹æ¡ˆ**ï¼š
   ```bash
   npm run build:solution
   ```

### å¦‚æœ FFmpeg ä¸å¯ç”¨

1. **æ‰‹å‹•è¤‡è£½ FFmpeg**ï¼š
   ```bash
   npm run copy:ffmpeg
   ```

2. **é©—è­‰è¤‡è£½çµæœ**ï¼š
   ```bash
   npm run test:gif:output
   ```

### å¦‚æœéœ€è¦ç®¡ç†å“¡æ¬Šé™

1. ä»¥ç®¡ç†å“¡èº«ä»½é–‹å•Ÿ PowerShell æˆ– CMD
2. å°èˆªåˆ°å°ˆæ¡ˆç›®éŒ„
3. åŸ·è¡Œç·¨è­¯å‘½ä»¤

## ğŸ“ æª”æ¡ˆçµæ§‹

```
dist/
â””â”€â”€ ç’å¨œçš„ GIF å‹•ç•«è£½ä½œå™¨-win32-x64/
    â”œâ”€â”€ ç’å¨œçš„ GIF å‹•ç•«è£½ä½œå™¨.exe          # ä¸»ç¨‹å¼
    â”œâ”€â”€ ffmpeg.exe                          # FFmpeg åŸ·è¡Œæª”
    â”œâ”€â”€ ffmpeg-master-latest-win64-gpl-shared/  # å®Œæ•´ FFmpeg ç›®éŒ„
    â”œâ”€â”€ resources/
    â”‚   â””â”€â”€ app.asar                        # æ‡‰ç”¨ç¨‹å¼è³‡æº
    â”œâ”€â”€ locales/                            # èªè¨€æ–‡ä»¶
    â””â”€â”€ [å…¶ä»– Electron æª”æ¡ˆ]
```

## ğŸ‰ ç¸½çµ

é€šéä½¿ç”¨ electron-packager æ›¿ä»£ electron-builder ä¸¦å¯¦æ–½è‡ªå‹• FFmpeg è¤‡è£½æ©Ÿåˆ¶ï¼ŒæˆåŠŸè§£æ±ºäº†ï¼š

1. âœ… Windows ç¬¦è™Ÿé€£çµæ¬Šé™å•é¡Œ
2. âœ… FFmpeg è·¯å¾‘æª¢æ¸¬å•é¡Œ
3. âœ… GIF è¼¸å‡ºåŠŸèƒ½å•é¡Œ
4. âœ… ç·¨è­¯ç©©å®šæ€§å•é¡Œ

ç¾åœ¨å¯ä»¥ç©©å®šåœ°ç·¨è­¯å‡ºå®Œæ•´åŠŸèƒ½çš„ç’å¨œ GIF å‹•ç•«è£½ä½œå™¨æ‡‰ç”¨ç¨‹å¼ï¼
